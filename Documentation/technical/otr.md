# Off the Record messaging
Off the record messaging or OTR for short is a cryptographic protocol that provides encryption for instant messaging conversations. It is designed to provide forward secrecy, deniability and perfect forward secrecy. It is used by a number of instant messaging clients, including Pidgin, Adium, Jitsi, and Kopete.
## Perfect forward secrecy and Deniability
The main features of OTR is perfect forward secrecy and deniability. While regular encryption usually means that an intercepted message can't be read at first, it can still be proven that the message was sent (and encrypted) by a certain person since only this person has correct the cryptographic key. This is not the case with OTR. With OTR, it is impossible to prove that a certain message was sent by a certain person. This is achieved by using a technique called *perfect forward secrecy*. Secondly, classical encryption approaches include methods to ensure that messages have not been altered by chance or by a malicious actor. While this usually is a beneficial property, it also means that any and all messages encrypted and authenticated this way can be used against you in a court of law since you cannot deny having send those messages. This is why OTR provides *deniability*, which means that it is impossible to prove that a certain message was ever sent. This is achieved by using a technique called *deniable authentication*.

## How to avoid abuse
Assuming that OTR works perfectly fine in our system, it is absolutely possible to abuse it for nefarious purposes. For example it would be very simple to use it for trolling and spamming users but also for more nefariuos purposes like blackmailing, sexual assaults and other activities that are rightfully outlawed in most countries. So, we have two cases that need to be strictly separated: unrightful assault from outside actors against the two communicating parties they need to be able to defend against and make it impossible to use the communication against them in a court of law. On the other hand, we need to give each of the communicating parties the means to defend themselves against the other party, in case they are being abused in some way. This is done by electively invalidating the whole promise of OTR as outlined above by one of the communicating parties. This is done by embedding digital watermarks into the messages as they are displayed on the client of the user, so that a screenshot of the message can be used as evidence in a court of law. This is different from pure logs of the messages, since the digital watermark is not part of the message itself, but is added by the client of the user. This means that normal use benefits of perfect forward secrecy and deniability and raw logs can't be used as evidence, but screenshots by one of he parties can. This is a good compromise between the two cases outlined above.

## How to implement OTR

## Embedding digital watermarks
A nice way to accomplish this is by use of [JAB Code](https://tritonstore.com.au/what-are-jab-codes/), which is a kind of QR code using all colour channels to encode data, with no quiet zone and the ability to fit any rectangular shape. Adding and subtracting the JAB Code to the least significant bit of the colour channels of the image will not be visible to the human eye, but can be extracted by a computer. This means that the digital watermark can be embedded into the image without the user noticing it. The code can then be extracted from a screenshot and be used to prove that a certain message was sent by a certain user at a certain time and date to a certain recipient.